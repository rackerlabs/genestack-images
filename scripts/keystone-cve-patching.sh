#!/usr/bin/env bash

if [ ${OS_VERSION:-master} = "stable/2025.1" ]; then
    # CVE fixes CVE-2025-27516
    /var/lib/openstack/bin/pip install --upgrade \
                                       "Jinja2==3.1.6"
elif [ ${OS_VERSION:-master} = "stable/2024.1" ]; then
    # CVE fixes CVE-2024-34064,CVE-2024-56201,CVE-2024-56326,CVE-2025-27516,CVE-2024-36039,CVE-2024-42353,CVE-2024-34069,
    #           CVE-2024-49766,CVE-2024-49767,GHSA-h4gh-qq45-vh27,CVE-2023-29483,CVE-2024-3651,CVE-2024-35195,CVE-2024-37891,
    #           CVE-2024-12797,CVE-2025-47278
    /var/lib/openstack/bin/pip install --upgrade \
                                       "Flask==3.1.1" \
                                       "Jinja2==3.1.6" \
                                       "PyMySQL>=1.1.1,<1.2" \
                                       "WebOb==1.8.8" \
                                       "Werkzeug>=3.0.6,<3.2" \
                                       "cryptography==44.0.1" \
                                       "dnspython>=2.6.1,<2.7" \
                                       "eventlet>=0.35.2,<0.36" \
                                       "idna>=3.7,<3.8" \
                                       "requests==2.32.4" \
                                       "urllib3==1.26.19"
fi
