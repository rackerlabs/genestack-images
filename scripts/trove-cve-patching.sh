#!/usr/bin/env bash

if [ ${OS_VERSION:-master} = "stable/2025.1" ]; then
    # CVE fixes CVE-2025-27516,CVE-2024-47081,CVE-2025-4565, CVE-2025-66221, CVE-2025-58068, CVE-2025-8869, CVE-2025-50181
    /var/lib/openstack/bin/pip install --upgrade \
                                       "eventlet>=0.40.3" \
                                       "Jinja2==3.1.6" \
                                       "protobuf==5.29.5" \
                                       "requests==2.32.4" \
                                       "urllib3>=2.5.0" \
                                       "werkzeug>=3.1.4"
elif [ ${OS_VERSION:-master} = "unmaintained/2024.1" ]; then
    # CVE fixes CVE-2024-34064,CVE-2024-56201,CVE-2024-56326,CVE-2025-27516,CVE-2024-36039,CVE-2024-42353,GHSA-h4gh-qq45-vh27,
    #           CVE-2023-29483,CVE-2024-3651,CVE-2024-35195,CVE-2024-37891,CVE-2024-12797,CVE-2024-47081,CVE-2025-4565,
    #           CVE-2025-58068, CVE-2024-34069, CVE-2024-49766, CVE-2024-49767, CVE-2025-66221, CVE-2024-1135, CVE-2024-6827,
    #           CVE-2025-8869, CVE-2024-4340, CVE-2025-50181
    /var/lib/openstack/bin/pip install --upgrade \
                                       "cryptography>=46.0.3" \
                                       "dnspython==2.6.1" \
                                       "eventlet==0.40.3" \
                                       "gunicorn>=23.0.0" \
                                       "idna==3.7" \
                                       "Jinja2==3.1.6" \
                                       "protobuf==4.25.8" \
                                       "PyMySQL==1.1.1" \
                                       "pyopenssl>=25.3.0" \
                                       "requests==2.32.4" \
                                       "sqlparse>=0.5.0" \
                                       "urllib3>=2.5.0" \
                                       "WebOb==1.8.8" \
                                       "werkzeug>=3.1.4"
fi
