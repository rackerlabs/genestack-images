#!/usr/bin/env bash

if [ ${OS_VERSION:-master} = "stable/2025.1" ]; then
    # CVE fixes CVE-2025-27516,CVE-2024-47081,CVE-2025-58068,CVE-2025-50181
    # CVE-2025-66418,CVE-2025-66471
    /var/lib/openstack/bin/pip install --upgrade \
                                       "Jinja2==3.1.6" \
                                       "eventlet==0.40.3" \
                                       "requests==2.32.4" \
                                       "urllib3==2.6.0"

elif [ ${OS_VERSION:-master} = "stable/2024.2" ]; then
    # CVE fixes CVE-2024-34064,CVE-2024-56201,CVE-2024-56326,CVE-2025-27516,
    # CVE-2024-36039,CVE-2024-42353,GHSA-h4gh-qq45-vh27,CVE-2023-29483,
    # CVE-2024-3651,CVE-2024-35195,CVE-2024-37891,CVE-2024-12797,
    # CVE-2024-47081,CVE-2024-49767,CVE-2024-34069,CVE-2024-49766,
    # CVE-2025-58068,CVE-2025-50181,CVE-2025-66418,CVE-2025-66471
    /var/lib/openstack/bin/pip install --upgrade \
                                       "Jinja2==3.1.6" \
                                       "PyMySQL==1.1.1" \
                                       "WebOb==1.8.8" \
                                       "Werkzeug==3.1.4" \
                                       "cryptography==46.0.3" \
                                       "dnspython==2.6.1" \
                                       "eventlet==0.40.3" \
                                       "idna==3.7" \
                                       "requests==2.32.4" \
                                       "urllib3==2.6.0"

elif [ ${OS_VERSION:-master} = "unmaintained/2024.1" ]; then
    # CVE fixes CVE-2024-34064,CVE-2024-56201,CVE-2024-56326,CVE-2025-27516,
    # CVE-2024-36039,CVE-2024-42353,GHSA-h4gh-qq45-vh27,CVE-2023-29483,
    # CVE-2024-3651,CVE-2024-35195,CVE-2024-37891,CVE-2024-12797,
    # CVE-2024-47081,CVE-2024-49767,CVE-2024-34069,CVE-2024-49766,
    # CVE-2025-58068,CVE-2025-50181,CVE-2025-66418,CVE-2025-66471
    /var/lib/openstack/bin/pip install --upgrade \
                                       "Jinja2==3.1.6" \
                                       "PyMySQL==1.1.1" \
                                       "WebOb==1.8.8" \
                                       "Werkzeug==3.1.4" \
                                       "cryptography==46.0.3" \
                                       "dnspython==2.6.1" \
                                       "eventlet==0.40.3" \
                                       "idna==3.7" \
                                       "requests==2.32.4" \
                                       "urllib3==2.6.0"
fi
