#!/usr/bin/env bash

if [ ${OS_VERSION:-master} = "stable/2025.1" ]; then
    # CVE fixes CVE-2025-27516,CVE-2024-47081,CVE-2025-32873,CVE-2025-26699,CVE-2025-48432,CVE-2025-64459
    /var/lib/openstack/bin/pip install --upgrade \
                                       "Django==4.2.26" \
                                       "Jinja2==3.1.6" \
                                       "requests==2.32.4"
elif [ ${OS_VERSION:-master} = "unmaintained/2024.1" ]; then
    # CVE fixes CVE-2024-34064,CVE-2024-56201,CVE-2024-56326,CVE-2025-27516,CVE-2024-36039,CVE-2024-42353,CVE-2024-47081
    #           CVE-2024-39329,CVE-2024-41989,CVE-2024-41990,CVE-2024-41991,CVE-2024-45230,CVE-2024-56374,CVE-2025-26699
    #           CVE-2025-32873,CVE-2025-48432,CVE-2025-32873,CVE-2025-48432,CVE-2024-38875,CVE-2024-39330,CVE-2024-27351
    #           CVE-2024-39614,CVE-2024-53907,CVE-2024-4340,CVE-2024-42005,CVE-2024-45231, CVE-2025-59681,CVE-2025-64459
    /var/lib/openstack/bin/pip install --upgrade \
                                       "Django==4.2.26" \
                                       "Jinja2==3.1.6" \
                                       "PyMySQL==1.1.1" \
                                       "WebOb==1.8.8" \
                                       "cryptography==44.0.1" \
                                       "dnspython==2.6.1" \
                                       "eventlet==0.40.3" \
                                       "idna==3.7" \
                                       "pymongo==4.6.3" \
                                       "requests==2.32.4" \
                                       "sqlparse==0.5.0" \
                                       "urllib3==1.26.20"
fi
