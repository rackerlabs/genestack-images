#!/usr/bin/env bash

if [ ${OS_CONSTRAINTS:-master} = "stable/2025.1" ]; then
    # CVE fixes CVE-2025-27516,CVE-2024-47081,CVE-2025-43859,CVE-2024-33663,
    #           CVE-2024-47874,CVE-2021-32677,CVE-2025-8869
    /var/lib/openstack/bin/pip install --upgrade \
                                       "pip==25.3" \
                                       "Jinja2==3.1.6" \
                                       "h11==0.16.0" \
                                       "pydantic==1.10.22" \
                                       "requests==2.32.4" \
                                       "urllib3==1.26.20" \
                                       "python-jose==3.4.0" \
                                       "starlette==0.48.0" \
                                       "fastapi==0.119.0"
elif [ ${OS_CONSTRAINTS:-master} = "stable/2024.2" ]; then
    # CVE fixes CVE-2024-3772,CVE-2025-43859,CVE-2024-56326,CVE-2025-27516,
    #           CVE-2024-56201,CVE-2024-56326,GHSA-h4gh-qq45-vh27,
    #           CVE-2024-47081,CVE-2024-33663,CVE-2024-47874,CVE-2021-32677
    #           CVE-2025-8869
    /var/lib/openstack/bin/pip install --upgrade \
                                       "pip==25.3" \
                                       "Jinja2==3.1.6" \
                                       "cryptography==43.0.1" \
                                       "h11==0.16.0" \
                                       "pydantic==1.10.22" \
                                       "requests==2.32.4" \
                                       "urllib3==1.26.20" \
                                       "python-jose==3.4.0" \
                                       "starlette==0.48.0" \
                                       "fastapi==0.119.0"
fi
